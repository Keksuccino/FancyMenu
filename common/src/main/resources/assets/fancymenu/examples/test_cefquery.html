<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CEF Query Test</title>
</head>
<body>
    <h1>CEF Query Test</h1>
    <button onclick="testCefQuery()">Test cefQuery</button>
    <div id="output"></div>
    
    <script>
        function log(msg) {
            document.getElementById('output').innerHTML += msg + '<br>';
            console.log(msg);
        }
        
        // Check immediately
        log('On page load - typeof window.cefQuery: ' + typeof window.cefQuery);
        log('On page load - typeof cefQuery: ' + typeof cefQuery);
        
        // Check after delay
        setTimeout(function() {
            log('After 1s - typeof window.cefQuery: ' + typeof window.cefQuery);
            log('After 1s - typeof cefQuery: ' + typeof cefQuery);
        }, 1000);
        
        function testCefQuery() {
            if (typeof window.cefQuery === 'function') {
                log('Calling cefQuery...');
                window.cefQuery({
                    request: 'test',
                    onSuccess: function(response) {
                        log('Success: ' + response);
                    },
                    onFailure: function(code, msg) {
                        log('Failure: ' + code + ' - ' + msg);
                    }
                });
            } else {
                log('cefQuery is not available!');
            }
        }
    </script>
</body>
</html>
